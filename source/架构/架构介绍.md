# 架构理论基础
系统架构设计描述了在应用内部，如何根据业务、技术、组织、灵活性、可扩展性以及可维护性等多种因素，将应用系统划分成不同的部分，并使这些部分彼此之间相互分工、相互协作、从而为用户提供某种特定价值的方式。
## 单块架构
单块架构的特点为：功能集中、代码中心化、一个发布包、部署后运行在统一进程。

单块架构的优势在于：
1. 易于开发；
2. 易于测试；
3. 易于部署；
4. 易于水平伸缩。

而单块架构面临的挑战在于：
1. 维护成本增加；
2. 持续交付周期长；
3. 新人培养周期长；
4. 技术选型成本高；
5. 可扩展性差：垂直扩展、水平拓展；
6. 构建全功能团队难。
### 三层架构
将系统中不同职责的部分划分为：
* 表示层：聚焦数据显示和用户交互
* 业务逻辑层：聚焦业务逻辑处理
* 数据访问层：聚焦数据的存储与访问

优点在于减少了耦合。通过在各层间定义接口，并将接口与实现隔离，可以轻易地用不同的实现替换原有层次的实现，从而降低层与层之间的依赖。另外，三层架构还有助于企业将人员按照不同的技能进行调配，提高生产效率。

## 微服务
微服务架构是一种架构模式，它提倡将单一应用程序划分成一组小的服务，服务之间互相协调、配合，为用户提供最终价值。每个服务运行在独立的进程中，服务间采用通信机制沟通。每个服务都围绕具体业务进行构建，并且能够独立部署到生产环境、类生产环境等。另外，应尽量避免统一的、集中式的服务管理机制，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具对其进行构建。

微服务的诞生背景是互联网行业的快速发展。与此同时，敏捷、精益、持续交付等价值观和方法论的提出和实践，也让很多组织意识到应对市场变化、提高响应力的重要性。精益创业（Lean Startup）通过迭代持续改进，帮助组织分析并建立最小可实行产品（Minimum Viable Product）；敏捷方法帮助组织消除浪费，通过反馈不断找到正确的方向；持续交付帮助组织构建更快、更可靠、可频繁发布的交付机制；云、虚拟化和基础设置自动化（Infrastructure As Code）的使用则极大简化了基础设施的创建、配置以及系统的安装和部署；DevOps文化的推行更是打破了传统开发与运维之间的壁垒，帮助组织形成全功能化的高效能团队……

除此之外，基于容器技术的Docker也有效地解决了微服务架构下，服务粒度细、服务数量多所导致的开发环境搭建、部署以及运维成本高的问题。并且Docker容器化技术还可以实现在一个节点上运行成百上千的Docker容器。因此，Docker有效解决了微服务的环境搭建、部署以及运维成本高的问题。以上这些因素推动了微服务的大规模应用。

事实上，微服务架构也并非是一个全新的概念。早在1996年Gartner提出的面向服务架构（SOA），思想上就与我们今天使用的微服务思想几乎一直。SOA指的是对于复杂的企业IT系统，应按照不同的、可重用的粒度划分，将功能相关的一组功能提供者组织在一起为消费者提供服务。由于SOA是面向企业提出的，而微服务是面向团队，使得SOA不具备微服务的灵活性，而微服务作为SOA的一个子集，反而获得了更多的关注。

在我们选择微服务架构时，应当关注到架构的优点：独立性、单一职责、技术多样性，以及考虑如下因素：分布式系统的复杂度、运维成本、部署自动化、DevOps与组织架构、服务间依赖测试、服务间依赖管理。
### 什么是微服务
微服务架构其实是将单一的应用程序划分成一组小的服务，每个服务都是具有业务属性的独立单元，同时能够被独立开发、独立运行、独立测试以及独立部署。
#### 微服务的“微”
微服务有多微是一个有趣且有争议的话题。存在不同的标准：1. 代码行数；2. 重写时间；3. 团队觉得好才是真的好（业务独立性、团队自主性）。

在面向对象中，有一个准则放之四海而皆准——“SOLID原则”。其中，SRP（单一职责原则）是非常重要的一部分。单一职责指的是一个对象有且只有一个发生变化的原因，如果一个对象可被多个原因改变，那么就说明这个对象承担了多个职责。

类似的，对于每个服务而言，服务架构层面也应当遵循单一职责原则。也就是说，微服务架构中的每个服务，都是具有业务逻辑的，符合高内聚、低耦合原则以及单一职责原则的单元。不同的服务灵活组合，构建出庞大的系统。

#### 微服务通信
微服务的服务之间应当通过轻量级的通信机制，实现彼此的互联互通，互相协作。所谓轻量级通信机制，通常指语言无关、平台无关的交互方式。

#### 独立性与进程隔离
微服务的应用在交付过程中，开发、测试、部署等都应当是独立的。

微服务架构中，应用程序由多个服务组成，每个服务都是一个具有高度自治的独立业务实体。通常情况下，每个服务都能运行在一个独立的操作系统进程中，这就意味着不同的服务能非常容易地被部署到不同的主机上。

### 微服务的本质
所谓本质特征，就是当我们谈论同一件事情的时候，不同的人们所关注的相同的部分。从业界的讨论来看，微服务的本质特征通常包括如下几个部分：
* **服务作为组件** ：如果把微服务作为组件，同传统使用组件方式最大的区别是，组件可以被独立部署。优点则在于能以松散的服务方式构建可独立部署的模块化应用；以及组件间定义了清晰的、语言无关、平台无关的接口。
* **围绕业务组织团队**
* **关注产品而非项目**
* **技术多样性** ：由于问题有其具体性，解决方案也应有针对性。用最适合的技术方案去解决具体的问题，往往会事半功倍。
* **业务数据独立** ：微服务架构提倡服务自助管理其相关的业务数据，因此能够随着业务的发展提供业务数据接口集成，而非数据库；并且能够选择更适合的工具管理或者迁移业务处理数据。
* **基础设施自动化**
* **演进式架构** ：拥抱变化、尝试改变、获取反馈。
## 参考与推荐
ThoughtWorks技术雷达
